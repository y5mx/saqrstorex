Date.prototype.addDays=function(days){var date=new Date(this.valueOf());date.setDate(date.getDate()+days);return date;}
function getDates(startDate,stopDate,tz='+3000'){var dateArray=new Array();var currentDate=startDate;while(currentDate<=stopDate){dateArray.push(moment(currentDate).utcOffset(tz));currentDate=currentDate.addDays(1);}
return dateArray;}
(function($){var submitButtonCart=$("#submit_cart");$('.bootstrap-select').selectpicker();$(".control-info").uniform({radioClass:'choice',wrapperClass:'border-info-600 text-info-800'});if($('textarea').length){autosize($('textarea'));}
function stopSubmitButtonCart(state=false){if(state){submitButtonCart.addClass('disabled').attr('disabled',true).html('<span class="submit-loader-cont"><img src="themes/default/assets/css/ajax-loader.gif" /> ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</span>');}else{submitButtonCart.attr('disabled',false).removeClass('disabled').html('<span>Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨</span><i class="icon-chevron-left"></i>');}}
function cartUploader(item,product_id,imagesArray){if(!$('.cart-uploader-'+item).length){return;}
$('.cart-uploader-'+item).filepond({server:{process:{url:baseUrl+'/cart/image',method:'POST',headers:{'Accept':'application/json','X-CSRF-TOKEN':_token},onload:function(response){},onerror:function(response){var error_message='Ø­ØµÙ„ Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹! Ù†Ø±Ø¬Ùˆ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©';response=JSON.parse(response);if(response.error.fields.image_file[0]){error_message=response.error.fields.image_file[0];}
return error_message;},ondata:function(formData){formData.append('_token',_token);formData.append('cart_item_id',item);formData.append('product_id',product_id);return formData;},},revert:function(uniqueFileId,load,error){},},beforeRemoveFile:function(photo){if(imagesArray){var imageToDelete=imagesArray.filter(function(obj){return((obj.path===item.source)||(obj.source===item.source));});if(imageToDelete.length>0){var photo_id=imageToDelete[0].key;if(!photo_id){photo_id=imageToDelete[0].source;}
if(!photo_id){return;}
axios.delete(baseUrl+'/cart/image/'+photo_id).then(function(response){if(response.data==='success'){laravel.jGrowl(response.data[0],'success');}}).catch(function(response){var error=response.data.error;if((error)&&!$.isEmptyObject(error.fields)){$.each(error.fields,function(key,value){laravel.jGrowl(value,'error');});}});}}},files:imagesArray,name:'file',instantUpload:true,allowFileTypeValidation:true,acceptedFileTypes:['image/*','application/pdf','application/vnd.openxmlformats-officedocument.wordprocessingml.document','application/msword','application/vnd.ms-excel','application/vnd.openxmlformats-officedocument.spreadsheetml.sheet','application/vnd.ms-powerpoint','video/quicktime','video/mp4','application/postscript'],dropValidation:true,allowImageResize:true,allowImageCrop:true,allowImageTransform:true,imageResizeUpscale:false,imageTransformVariantsIncludeOriginal:false,imageTransformOutputMimeType:'image/jpeg',imageTransformOutputQuality:80,imageTransformClientTransforms:'resize',allowMultiple:true,checkValidity:true,allowImageValidateSize:true,imageResizeTargetWidth:800,imageResizeTargetHeight:800,maxFileSize:'10MB',maxFiles:5,labelIdle:'Ø§Ø³Ø­Ø¨ Ùˆ Ø£ÙÙ„Øª Ø§Ù„Ù…Ù„Ù Ù‡Ù†Ø§<span class="filepond--label-action">Ø£Ùˆ ØªØµÙØ­ Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ</span>',labelMaxFileSizeExceeded:'Ø§Ù„Ù…Ù„Ù ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§',labelMaxFileSize:'Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù Ù‡Ùˆ {filesize}',labelMaxTotalFileSizeExceeded:'ØªÙ… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ø­Ø¬Ù… Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ',labelMaxTotalFileSize:'Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù Ø§Ù„ÙƒÙ„ÙŠ Ù‡Ùˆ {filesize}',labelTapToCancel:'Ø§Ø¶ØºØ· Ù„Ù„Ø§Ù„ØºØ§Ø¡',labelFileTypeNotAllowed:'ÙŠØ³Ù…Ø­ ÙÙ‚Ø· Ø¨Ø±ÙØ¹ ØµÙˆØ± Ù…Ù† Ù†ÙˆØ¹ : jpg, png, jpeg.',labelFileWaitingForSize:'ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø©',labelFileSizeNotAvailable:'Ø­Ø¬Ù… Ø§Ù„ØµÙˆØ±Ø© ØºÙŠØ± Ù…ØªÙˆÙØ± Ù†Ø±Ø¬Ùˆ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø§Ø®Ø±Ù‰',labelFileLoadError:'Ø­ØµÙ„ Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹!',labelFileProcessing:'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...',labelFileProcessingComplete:'ğŸ‘',labelFileProcessingAborted:'ØªÙ… Ø§Ù„ØºØ§Ø¡ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ­Ù…ÙŠÙ„',labelFileProcessingError:(error)=>{var error_message='Ø­ØµÙ„ Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹! Ù†Ø±Ø¬Ùˆ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©';if(error.body){error_message=error.body;}
return error_message;},labelFileProcessingRevertError:'Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø±Ø¬ÙˆØ¹',labelFileRemoveError:'Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ø°Ù',labelTapToRetry:'Ø§Ø¶ØºØ· Ù„Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ù‡ Ø§Ø®Ø±Ù‰',labelTapToUndo:'Ø§Ø¶ØºØ· Ù„Ù„Ø±Ø¬ÙˆØ¹',labelButtonRemoveItem:'Ø­Ø°Ù',labelButtonAbortItemLoad:'Ø§Ù„ØºØ§Ø¡',labelButtonRetryItemLoad:'Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©',labelButtonAbortItemProcessing:'Ø§Ù„ØºØ§Ø¡',labelButtonUndoItemProcessing:'Ø±Ø¬ÙˆØ¹',labelButtonRetryItemProcessing:'Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©',labelButtonProcessItem:'Ø±ÙØ¹',});}
$(".product-cart").each(function(){var cart_id=$(this).data('itemid');var product_id=$(this).data('productid');var imagesArray=[];if($(this).find('.uploaded_image_row').length){$(this).find('.uploaded_image_row').each(function(i){var ext=($(this).data('path')).split(".");if(ext[ext.length-1]){ext=ext[ext.length-1];}else{ext='jpeg';}
imagesArray.push({source:$(this).data('key'),options:{type:'local',file:{name:$(this).data('key')+'.'+ext,size:1000000,},metadata:{poster:$(this).data('path')}}});});}
cartUploader(cart_id,product_id,imagesArray);$(this).find(".option-uploader-field").each(function(){var _index=$(this).data('index');var temp_count_image=$(this).closest('.product-options').find('img').length;if(temp_count_image>0){$("#field_"+_index).closest('.form-group').css({height:$("#field_"+_index).closest('.div-product-option-value').height()+27});}});$(this).find('.notes-upload-fields .filepond--list').children().length>0?$(this).find('[data-button-hidden-uploader]').addClass('active'):null;$(this).find('[data-button-hidden-uploader]').on('click',function(){$('.file-input.'+$(this).data('button-hidden-uploader')).toggleClass('hidden');$(this).toggleClass('active');})
$(this).find('.product-note').is(':visible')?$(this).find('.btn-add-note').addClass('active'):null;});$(".mulit_field").each(function(){checkboxfield($(this))});$('.mulit_field').on('change',function(){checkboxfield($(this));updateServiceProduct($(this).closest('.product-cart').attr('data-itemid'));});$(".select-new, .prod-options-list").on('change',function(e){if($(this).is('input')||$(this).is('select')){updateBasicProduct($(this).attr('data-itemid'))}});$(".btn--qty-add,.btn--qty-sub").on('click',function(e){var input=$(this).closest('.qty-field--custom').find('.single_product_quantity');var itemid=input.attr('data-itemid');stopSubmitButtonCart(true);setTimeout(function(){if(input.data('type')&&input.data('type')=='quantity'){updateBasicProduct(input.attr('data-itemid'));}else if(itemid){updateServiceProduct(input.attr('data-itemid'));}},1000);});$('.select-service-new').on('change',function(e){var itemid=$(this).attr('data-itemid');if(itemid){updateServiceProduct($(this).attr('data-itemid'));}});$('select.prod-options-list, input.prod-options-list').change(function(){checkAvailableQuantity($(this).closest('.product-cart'));});$(document).on('click','#submit_cart',function(event){event.preventDefault();Salla.event.createAndDispatch('cart::submit');});$(document).on('cart::submit',function(event){event.preventDefault();var _check_quantity=true;var msg="";$('select.prod-quantity,input.prod-quantity').each(function(i){var data_id=$(this).attr('id');if($(this).val()==0){_check_quantity=false;$(this).css({"border-color":"#f55157"});msg=$(this).attr('product_name')+" <br> "+msg;}});if(_check_quantity==false){laravel.jGrowl(" Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ­Ø¯ÙŠØ¯ ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ù†ØªØ¬: "+msg,'error');return false;}
var _check_option=true;$('select.prod-options-list').each(function(i){var data_id=$(this).attr('id');var option_length=$('select#'+data_id+' option').length;if(option_length>1){if($(this).val()=='-'){_check_option=false;$('select[data-id='+data_id+']').css({"border-color":"#f55157"});msg=$(this).attr('data-product-name')+" <br> "+msg;}}});$('.div-prod-options-list').each(function(){var have_check_value=false;$(this).find('.prod-options-list ').each(function(){if($(this).is(':radio')&&$(this).is(':checked')){have_check_value=true;}});if(!have_check_value){_check_option=false;$(this).css({"border-color":"#f55157"});msg=$(this).attr('data-product-name')+" <br> "+msg;}});if(_check_option==false){laravel.jGrowl(" Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ­Ø¯ÙŠØ¯ Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬: "+msg,'error');return false;}
submitCart(event.originalEvent.detail);});function checkAvailableQuantityOfCart(){$('.product-cart').each(function(){checkAvailableQuantity($(this));});}
function checkAvailableQuantity(element_product_cart){var product_id=element_product_cart.data('productid');if(element_product_cart.find('select.prod-options-list, input.prod-options-list').length){var list_option_detail_id=[];element_product_cart.find('select.prod-options-list, input.prod-options-list').each(function(){if(($(this).val()&&$(this).val()!='-')&&(($(this).is('select'))||($(this).is(':radio')&&$(this).is(':checked')))){list_option_detail_id.push($(this).val());}});if(list_option_detail_id){getAvailableQuantity(element_product_cart,product_id,list_option_detail_id);}}else{getAvailableQuantity(element_product_cart,product_id);}}
function checkboxfield(elem){var option_id='';var cur_val='';var cur_val_data='';var object_product_cart=elem.closest('.product-cart');selectedOptions=getSelectedArray(elem);if(elem.is('select')){clearRelatedCondition(elem);elem.selectpicker('destroy');option_id=elem.find(':selected').attr('data-option-id');cur_val=elem.find(':selected').attr('data-option_detail_id');cur_val_data=elem.find(':selected').attr('data-field_value');elem.selectpicker();}else if(elem.attr('type')=='checkbox'){clearRelatedCondition(elem);if(elem.is(':checked')){option_id=elem.attr('data-option-id');cur_val=elem.attr('data-option_detail_id');cur_val_data=elem.attr('data-field_value');}}
$.uniform.update();if(cur_val_data){cur_val_data=cur_val_data.trim();}
if(cur_val){object_product_cart.find("[data-condition-field-id='"+option_id+"']").each(function(){loopThrowHiddenField(object_product_cart,cur_val,cur_val_data,$(this),selectedOptions);});}else{selectRelatedCondition(object_product_cart,elem,selectedOptions);}
$.uniform.update();}
function loopThrowHiddenField(object_product_cart,cur_val,cur_val_data,hidden_elem,selectedOptions)
{var data_condition_field_id=hidden_elem.attr("data-condition-field-id");var data_field_condition=hidden_elem.attr("data-field-condition");var data_condition_field_option_id=hidden_elem.attr("data-condition-field-option-id");var data_field_id=hidden_elem.attr("data-field-id");if(data_condition_field_id){switch(data_field_condition){case "=":if(cur_val==data_condition_field_option_id&&selectedOptions.indexOf(data_condition_field_option_id)!==-1){object_product_cart.find('#field_section_'+data_field_id).show();var temp_div=object_product_cart.find('#field_section_'+data_field_id);temp_div.find('select').selectpicker('destroy');temp_div.find('select').prop('disabled',false);temp_div.find('input').prop('disabled',false);temp_div.find('textarea').prop('disabled',false);temp_div.find('select').selectpicker();}
break;case ">":var val_option_object=object_product_cart.find("[data-option_detail_id='"+data_condition_field_option_id+"']");if(val_option_object&&cur_val_data&&selectedOptions.indexOf(cur_val)!==-1){var val_option_data=val_option_object.attr('data-field_value');val_option_data=val_option_data.trim();if(cur_val_data>val_option_data){object_product_cart.find('#field_section_'+data_field_id).show();var temp_div=object_product_cart.find('#field_section_'+data_field_id);temp_div.find('select').selectpicker('destroy');temp_div.find('select').prop('disabled',false);temp_div.find('input').prop('disabled',false);temp_div.find('textarea').prop('disabled',false);temp_div.find('select').selectpicker();}}
break;case "<":var val_option_object=object_product_cart.find("[data-option_detail_id='"+data_condition_field_option_id+"']");if(val_option_object&&cur_val_data&&selectedOptions.indexOf(cur_val)!==-1){var val_option_data=val_option_object.attr('data-field_value');val_option_data=val_option_data.trim();if(cur_val_data<val_option_data){object_product_cart.find('#field_section_'+data_field_id).show();var temp_div=object_product_cart.find('#field_section_'+data_field_id);temp_div.find('select').selectpicker('destroy');temp_div.find('select').prop('disabled',false);temp_div.find('input').prop('disabled',false);temp_div.find('textarea').prop('disabled',false);temp_div.find('select').selectpicker();}}
break;case "!=":if(cur_val!=data_condition_field_option_id&&selectedOptions.indexOf(data_condition_field_option_id)===-1){object_product_cart.find('#field_section_'+data_field_id).show();var temp_div=object_product_cart.find('#field_section_'+data_field_id);temp_div.find('select').selectpicker('destroy');temp_div.find('select').prop('disabled',false);temp_div.find('input').prop('disabled',false);temp_div.find('textarea').prop('disabled',false);temp_div.find('select').selectpicker();}
break;default:object_product_cart.find('#field_section_'+data_field_id).hide();var temp_div=object_product_cart.find('#field_section_'+data_field_id);temp_div.find('select').selectpicker('destroy');temp_div.find('select').prop('disabled',true);temp_div.find('input').prop('disabled',true);temp_div.find('textarea').prop('disabled',true);temp_div.find('select').selectpicker();}}}
function clearRelatedCondition(elem){var object_product_cart=elem.closest('.product-cart');if(elem.is('select')){elem.selectpicker('destroy');var element_val=elem.find('option:selected').attr('data-field_value');if(element_val){element_val=element_val.trim();}
elem.find('option').each(function(){var elem_option=$(this);var disable_data=false;cur_val=$(this).attr('data-option_detail_id');cur_val_data=$(this).attr('data-field_value');if(cur_val){object_product_cart.find("[data-condition-field-option-id='"+cur_val+"']").each(function(){var temp=$(this);if(temp.attr('data-field-condition')=='='){if(!elem_option.is(':selected')){disable_data=true;}}else if(temp.attr('data-field-condition')=='!='){if((elem_option.is(':selected'))){disable_data=true;}}else if(temp.attr('data-field-condition')=='>'){if((element_val&&cur_val_data)&&(!(element_val>cur_val_data))){disable_data=true;}}else if(temp.attr('data-field-condition')=='<'){if((element_val&&cur_val_data)&&(!(element_val<cur_val_data))){disable_data=true;}}
if(disable_data){temp.closest('.form-group').hide();var temp_div=temp.closest('.form-group');temp_div.find('select').prop('disabled',true);temp_div.find('input').prop('disabled',true);temp_div.find('textarea').prop('disabled',true);if(temp.attr('type')=='checkbox'){temp.prop('checked',false);clearRelatedCondition($(this));}else if(temp.is('select')){temp.find('option:selected').removeAttr('selected');clearRelatedCondition(temp);}else{temp.val('');}}});}});elem.selectpicker();}else if(elem.attr('type')=='checkbox'){elem.closest('.form-group').find('input[type=checkbox]').each(function(){var elem_option=$(this);var disable_data=false;cur_val=$(this).attr('data-option_detail_id');cur_val_data=$(this).attr('data-field_value');if(cur_val){object_product_cart.find("[data-condition-field-option-id='"+cur_val+"']").each(function(){var temp=$(this);if(temp.attr('data-field-condition')=='='){if(!elem_option.is(':checked')){disable_data=true;}}else if(temp.attr('data-field-condition')=='!='){if(elem_option.is(':checked')){disable_data=true;}}else if(((temp.attr('data-field-condition')=='>')||(temp.attr('data-field-condition')=='<'))){var have_field_achieve_value=false;elem.closest('.form-group').find('input[type=checkbox]').each(function(){if($(this).is(':checked')){var element_val=$(this).attr('data-field_value');if(element_val){element_val=element_val.trim();}
if(temp.attr('data-field-condition')=='>'){if((element_val&&cur_val_data)&&(element_val>cur_val_data)){have_field_achieve_value=true;return false;}}else if(temp.attr('data-field-condition')=='<'){if((element_val&&cur_val_data)&&(element_val<cur_val_data)){have_field_achieve_value=true;return false;}}}});if(!have_field_achieve_value){disable_data=true;}}
if(disable_data){temp.closest('.form-group').hide();var temp_div=temp.closest('.form-group');temp_div.find('select').prop('disabled',true);temp_div.find('input').prop('disabled',true);temp_div.find('textarea').prop('disabled',true);if(temp.attr('type')=='checkbox'){temp.prop('checked',false);clearRelatedCondition($(this));}else if(temp.is('select')){temp.find('option:selected').removeAttr('selected');clearRelatedCondition(temp);}else{temp.val('');}}});}});}
$.uniform.update();}
function getSelectedArray(elem)
{var selectedArray=[];if(elem.is('select')){elem.find('option').each(function(){if($(this).is(':selected')){selectedArray.push($(this).attr('data-option_detail_id'));}});}else if(elem.attr('type')=='checkbox'){elem.closest('.form-group').find('input[type=checkbox]').each(function(){if($(this).is(':checked')){selectedArray.push($(this).attr('data-option_detail_id'));}});}
return selectedArray;}
function selectRelatedCondition(object_product_cart,elem,selectedOptions)
{if(elem.is('select')){elem.selectpicker('destroy');elem.find('option').each(function(){var elem_option=$(this);cur_val=elem_option.attr('data-option_detail_id');cur_val_data=elem_option.attr('data-field_value');option_id=elem_option.attr('data-option-id');object_product_cart.find("[data-condition-field-id='"+option_id+"']").each(function(){loopThrowHiddenField(object_product_cart,cur_val,cur_val_data,$(this),selectedOptions);});});elem.selectpicker();}else if(elem.attr('type')=='checkbox'){elem.closest('.form-group').find('input[type=checkbox]').each(function(){var elem_option=$(this);cur_val=elem_option.attr('data-option_detail_id');cur_val_data=elem_option.attr('data-field_value');option_id=elem_option.attr('data-option-id');object_product_cart.find("[data-condition-field-id='"+option_id+"']").each(function(){loopThrowHiddenField(object_product_cart,cur_val,cur_val_data,$(this),selectedOptions);});});}
$.uniform.update();}
function updateItem(item_id,quantity,options,notes,amount_donating){$.ajax({url:baseUrl+"/cart/item/"+item_id,data:{_token:_token,quantity:quantity,options:options,notes:notes,amount_donating:amount_donating},dataType:"json",type:'PUT',success:function(resp){$.each(resp.data.items,function(index,product){if(product.type!='donating'){$('#product-price-'+product.id).fadeTo('slow',0.1).fadeTo('slow',1.0).text(product.product_price_formatted);if(!product.offer){$('#itemOffer-'+product.id).hide();$('#itemTotal-'+product.id).removeClass('price-before');}else if(product.offer){$('#itemTotal-'+product.id).addClass('price-before');$('#itemOffer-'+product.id).show();$('#itemOffer-price-'+product.id).fadeTo('slow',0.1).fadeTo('slow',1.0).text(product.offer.is_free?'Ù…Ø¬Ø§Ù†ÙŠ':product.offer.total_product_after_discount_formatted);$('#itemOffer-name-'+product.id).fadeTo('slow',0.1).fadeTo('slow',1.0).text(product.offer.offer_names);}
$('#itemTotal-'+product.id).fadeTo('slow',0.1).fadeTo('slow',1.0).text(product.total_product_price_formatted);}else{var _product_price=(product._product_price>0)?product._product_price:null;$('#donating_mount_'+product.id).val(Number(_product_price));}
if(product.offer){$('#item-'+product.id).attr('data-price',product.offer.total_product_after_discount);}else{$('#item-'+product.id).attr('data-price',product.total_product_price);}
if($('#item-'+product.id).find('.product-weight').length&&product.weight_label){$('#item-'+product.id).find('.product-weight').html(product.weight_label);}});$('#cartTotal').fadeTo('slow',0.1).fadeTo('slow',1.0).text(resp.data.total);if($('#cartTotalWeight').length){if(resp.data.total_weight){$('#cartTotalWeight').closest('.cart-total-box').show();$('#cartTotalWeight').fadeTo('slow',0.1).fadeTo('slow',1.0).text(resp.data.total_weight);}else{$('#cartTotalWeight').closest('.cart-total-box').hide();}}
if($('#cartCouponDiscount').length){$('#cartCouponDiscount').fadeTo('slow',0.1).fadeTo('slow',1.0).text(resp.data.coupon_discount);}
laravel.ajax.successHandler(resp);},error:function(e){laravel.ajax.errorHandler(e);if(amount_donating){var old_price=$('#donating_mount_'+item_id).data('product-price');$('#donating_mount_'+item_id).val(old_price);}
if(($('body').find('#item-'+item_id))){checkAvailableQuantity($('body').find('#item-'+item_id));}},}).always(function(){stopSubmitButtonCart(false);});}
function updateBasicProduct(cart_id){var _check_quantity=true;var msg="";if($('#quantity_'+cart_id).val()==0){_check_quantity=false;$('#quantity_'+cart_id).css({"border-color":"#f55157"});msg=$('#quantity_'+cart_id).attr('product_name')+" <br> "+msg;}
if(_check_quantity==false){laravel.jGrowl(" Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ­Ø¯ÙŠØ¯ ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ù†ØªØ¬: "+msg,'error');return false;}
var _check_basic_option=true;var options=[];$(".basic-product-"+cart_id).each(function(_elem){var _elem=$(this);if(_elem.val()=='-'&&_elem.attr('data-type')=="option"){_elem.css({"border-color":"#f55157"});_check_basic_option=false;msg=$(this).attr('data-product-name')+" <br> "+msg;}
if(_elem.attr('data-type')=="option"){options.push(_elem.val());}else{_elem.find('.prod-options-list').each(function(){_elem2=$(this);if(_elem2.is(':radio')&&_elem2.is(':checked')){options.push(_elem2.val());}});}});if(_check_basic_option){var quantity=$('#quantity_'+cart_id).val();var notes='';if($('#notes_'+cart_id).length){notes=$('#notes_'+cart_id).val();}
updateItem(cart_id,quantity,options,notes)}else{laravel.jGrowl(" Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ­Ø¯ÙŠØ¯ Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬: "+msg,'error');}}
function updateServiceProduct(item_id){var _check_quantity=true;var msg="";if($('#quantity_'+item_id).val()==0){_check_quantity=false;$('#quantity_'+item_id).css({"border-color":"#f55157"});msg=$('#quantity_'+item_id).attr('product_name')+" <br> "+msg;}
if(_check_quantity==false){laravel.jGrowl(" Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ­Ø¯ÙŠØ¯ ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ù†ØªØ¬: "+msg,'error');return false;}
var elements=getServiceOptions($('#item-'+item_id).find(".element-product-option-detail"));var notes='';if($('#notes_'+item_id).length){notes=$('#notes_'+item_id).val();}
updateItem(item_id,$('#quantity_'+item_id).val(),elements,notes)}
function submitCart(event){event=event||{};showLoading()
$.ajax({url:baseUrl+'/cart',data:{"has_apple_pay":!!window.ApplePaySession},dataType:'json',type:'POST',success:function(resp){hideLoading()
if(resp.data.redirect.to==="login"){document.dispatchEvent(new Event('auth'));}
if(resp.data.redirect.to==='refresh'){window.location.reload();}
if(resp.data.redirect.to==="shipping"){window.location=baseUrl+"/shipping";}
if(resp.data.redirect.to==="payment"){window.location=baseUrl+"/payment";}
if(resp.data.redirect.to==="checkout"){window.location=resp.data.redirect.url;}},error:function(res){if(event.source==='auth'){window.location.reload();}else{laravel.ajax.errorHandler(res);}},});}
function getAvailableQuantity(container_cart,product_id,list_option_detail_id){var url=baseUrl+"/get_product_info/"+product_id;$.ajax({url:url,type:'GET',data:{'list_option_detail_id':list_option_detail_id,},success:function(resp){var selector_quantity=container_cart.find('select.prod-quantity,input.prod-quantity');var selected_quantity=selector_quantity.val();var empty_quantity_option=selector_quantity.find('option[value="0"]');if(selector_quantity.is('select')){selector_quantity.html('');if(empty_quantity_option){selector_quantity.append('<option value="0">'+empty_quantity_option.text()+'</option>');}
for(i=1;i<=resp.product_available_quantity;i++){selector_quantity.append('<option value="'+i+'">'+arabic_number(i)+'</option>');}
selector_quantity.val(selected_quantity);if(selector_quantity.hasClass('bootstrap-select')){selector_quantity.selectpicker('refresh');}}else{selector_quantity.val(selected_quantity);}
if(selected_quantity>resp.product_available_quantity){selected_quantity=resp.product_available_quantity;selector_quantity.val(selected_quantity);if(selector_quantity.hasClass('bootstrap-select')){selector_quantity.selectpicker('refresh');}}}});}
$('.amount_donating_cls').on('change keyup paste',function(e){var item_id=$(this).attr('data-itemid');$('#btn_donating_mount_'+item_id).show();});$('.btn-donating-amount').on('click',function(event){var item_id=$(this).attr('data-itemid');var _amount=$('#donating_mount_'+item_id).val();updateItem(item_id,1,[],null,_amount);$(this).hide();});var timeout;$(".product-note").on('change keyup input paste',function(){var id=$(this).attr('data-item-id');clearTimeout(timeout);timeout=setTimeout(function(){if($('#item-'+id).find(".element-product-option-detail").length){updateServiceProduct(id);}else{updateBasicProduct(id);}},1000)});$(".text-element").bind("change keyup input paste",function(e){var id=$(this).closest('.product-cart').attr('data-itemid');clearTimeout(timeout);stopSubmitButtonCart(true);timeout=setTimeout(function(){updateServiceProduct(id);},1000)});$(".date-time-element").click(function(){var id=$(this).closest('.product-cart').attr('data-itemid'),calendar=$(this).parents('.input_datetime_picker'),times=!$.isEmptyObject(calendar.data('order-time'))?JSON.parse(JSON.stringify(calendar.data('order-time'))):[],tz=calendar.data('timezone')?calendar.data('timezone'):'+0300',fromDateTime=!$.isEmptyObject(calendar.data('from-date-time'))?JSON.parse(JSON.stringify(calendar.data('from-date-time'))):moment().utcOffset(tz),toDateTime=!$.isEmptyObject(calendar.data('to-date-time'))?JSON.parse(JSON.stringify(calendar.data('to-date-time'))):'',enabledDates=[];disabledDaysOfWeek=[];if(!$.isEmptyObject(times)){moment.weekdays().forEach(function(item,index){if(!times.hasOwnProperty(item.toLowerCase())){disabledDaysOfWeek.push(index);}})}
var isNotEmpty=function(value){return!["",undefined,null].includes(value)};if(isNotEmpty(fromDateTime)&&isNotEmpty(toDateTime)){var fromDate=new Date(fromDateTime);var toDate=new Date(toDateTime);enabledDates=getDates(fromDate,toDate,tz);}
function getDayName(day){return moment.weekdays()[day].toLowerCase()}
function isDayExistsInTimes(dayName){return!$.isEmptyObject(times)&&times.hasOwnProperty(dayName)&&times[dayName][0]}
function getTimeRangeByDay(dayName){let timeRange=times[dayName][0].split('-');return{minHours:parseInt(timeRange[0].split(':')[0]),maxHours:parseInt(timeRange[1].split(':')[0]),minMinutes:parseInt(timeRange[0].split(':')[1]),maxMinutes:parseInt(timeRange[1].split(':')[1]),}}
calendar.calendar({minDate:moment(fromDateTime).utcOffset(tz),className:{prevIcon:'sicon-arrow-left left',nextIcon:'sicon-arrow-right right',table:'ui celled center aligned unstackable table text-ltr',},formatter:{date:function(date,settings){if(!date)return '';return date.year()+'-'+(date.month()+1)+'-'+date.date();}},text:{days:['Ø­','Ø§Ø«','Ø«Ù„','Ø£Ø±','Ø®Ù…','Ø¬','Ø³'],months:["ÙŠÙ†Ø§ÙŠØ±","ÙØ¨Ø±Ø§ÙŠØ±","Ù…Ø§Ø±Ø³","Ø£Ø¨Ø±ÙŠÙ„","Ù…Ø§ÙŠÙˆ","ÙŠÙˆÙ†ÙŠÙˆ","ÙŠÙˆÙ„ÙŠÙˆ","Ø£ØºØ³Ø·Ø³","Ø³Ø¨ØªÙ…Ø¨Ø±","Ø£ÙƒØªÙˆØ¨Ø±","Ù†ÙˆÙÙ…Ø¨Ø±","Ø¯ÙŠØ³Ù…Ø¨Ø±",],},disabledDaysOfWeek:disabledDaysOfWeek,enabledDates:enabledDates,setInputValueOnMode:'minute',allowArrowsOnlyOnDays:true,enabledHours:function(date){let dayName=getDayName(date.day());if(!isDayExistsInTimes(dayName)){return true;}
let day=getTimeRangeByDay(dayName);let now=moment().utcOffset(tz);if(moment().utcOffset(tz).isSame(date,'day')&&now.hours()>date.hours()){return false;}
if(day.minHours<=date.hours()&&day.maxHours>=date.hours()){return true;}
return false;},enabledMinutes:function(date){let dayName=getDayName(date.day());if(!isDayExistsInTimes(dayName)){return true;}
let now=moment().utcOffset(tz);if(moment().utcOffset(tz).isSame(date,'day')&&now.hours()===date.hours()&&now.minutes()>date.minutes()){return false;}
let day=getTimeRangeByDay(dayName);if(day.minHours===date.hours()&&day.minMinutes>date.minutes()){return false;}
if(day.maxHours===date.hours()&&day.maxMinutes<date.minutes()){return false;}
return true;},onHidden:(date)=>{updateServiceProduct(id)}});});$(".time-element").click(function(){var id=$(this).closest('.product-cart').attr('data-itemid');$(this).parents('.input_time_picker').calendar({type:'time',className:{prevIcon:'sicon-arrow-left left',nextIcon:'sicon-arrow-right right',table:'ui celled center aligned unstackable table text-ltr',},onHidden:(date,mode)=>{updateServiceProduct(id)}});});$(".date-element").click(function(){var id=$(this).closest('.product-cart').attr('data-itemid');$(this).parents('.input_date_picker').calendar({minDate:moment(),className:{prevIcon:'sicon-arrow-left left',nextIcon:'sicon-arrow-right right',table:'ui celled center aligned unstackable table text-ltr',},type:'date',formatter:{date:function(date,settings){if(!date)return '';return date.year()+'-'+(date.month()+1)+'-'+date.date();}},text:{days:['Ø­','Ø§Ø«','Ø«Ù„','Ø£Ø±','Ø®Ù…','Ø¬','Ø³'],months:["ÙŠÙ†Ø§ÙŠØ±","ÙØ¨Ø±Ø§ÙŠØ±","Ù…Ø§Ø±Ø³","Ø£Ø¨Ø±ÙŠÙ„","Ù…Ø§ÙŠÙˆ","ÙŠÙˆÙ†ÙŠÙˆ","ÙŠÙˆÙ„ÙŠÙˆ","Ø£ØºØ³Ø·Ø³","Ø³Ø¨ØªÙ…Ø¨Ø±","Ø£ÙƒØªÙˆØ¨Ø±","Ù†ÙˆÙÙ…Ø¨Ø±","Ø¯ÙŠØ³Ù…Ø¨Ø±",],},onChange:function(){console.log('test');updateServiceProduct(id);}});});$(".single_product_quantity").keyup(function(){if($(this).val()<=0){$(this).val(1);}
var itemid=$(this).data('itemid');clearTimeout(timeout);stopSubmitButtonCart(true);timeout=setTimeout(function(){if($(this).data('type')&&$(this).data('type')=='quantity'){updateBasicProduct(itemid);}else if(itemid){updateServiceProduct(itemid);}},1000);});$(document).on('cart-submit::disabled',function(){stopSubmitButtonCart(true);});$(document).on('cart-submit::enabled',function(){stopSubmitButtonCart();});})(jQuery);